        <!DOCTYPE html>
        <html>
        <head>
                <meta charset="utf-8">
        <title>CanvasViewportTransform Class / box2d Library / Dart Documentation</title>
        <link rel="stylesheet" type="text/css"
            href="../styles.css">
        <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800" rel="stylesheet" type="text/css">
        <link rel="shortcut icon" href="../favicon.ico">
        
        </head>
        <body data-library="box2d" data-type="CanvasViewportTransform">
        <div class="page">
        <div class="header">
          <a href="../index.html"><div class="logo"></div></a>
          <a href="../index.html">Dart Documentation</a>
         &rsaquo; <a href="../box2d.html">box2d</a> &rsaquo; <a href="../box2d/CanvasViewportTransform.html">CanvasViewportTransform</a></div>
        <div class="nav">
        
</div>
<div class="content">
        <h2><strong>CanvasViewportTransform</strong>
          Class
        </h2>
        
<div class="doc">
<p>Transform for drawing using a canvas context. Y-flip is permenantly set
to true.</p>
</div>
<h3>Implements</h3>
<p>
<span class="type-box"><span class="icon-interface"></span><a href="../box2d/IViewportTransform.html">IViewportTransform</a></span></p>
<h3>Constructors</h3>
<div class="method"><h4 id="CanvasViewportTransform">
<span class="show-code">Code</span>
new <strong>CanvasViewportTransform</strong>(<a href="../box2d/Vector.html">Vector</a> extents, <a href="../box2d/Vector.html">Vector</a> center) <a class="anchor-link" href="#CanvasViewportTransform"
              title="Permalink to CanvasViewportTransform.CanvasViewportTransform">#</a></h4>
<div class="doc">
<p>Constructs a new viewport transform with the default scale.</p>
<pre class="source">
CanvasViewportTransform(Vector extents, Vector center) :
  extents = new Vector.copy(extents),
  center = new Vector.copy(center),
  scale = DEFAULT_DRAWING_SCALE { }
</pre>
</div>
</div>
<h3>Static Fields</h3>
<div class="field"><h4 id="DEFAULT_DRAWING_SCALE">
<span class="show-code">Code</span>
final <a href="../dart_core/int.html">int</a>         <strong>DEFAULT_DRAWING_SCALE</strong> <a class="anchor-link"
            href="#DEFAULT_DRAWING_SCALE"
            title="Permalink to CanvasViewportTransform.DEFAULT_DRAWING_SCALE">#</a>
        </h4>
        <div class="doc">

<pre class="source">
static final int DEFAULT_DRAWING_SCALE = 20;
</pre>
</div>
</div>
<h3>Methods</h3>
<div class="method"><h4 id="getScreenToWorld">
<span class="show-code">Code</span>
<a href="../dart_core/void.html">void</a> <strong>getScreenToWorld</strong>(<a href="../box2d/Vector.html">Vector</a> argScreen, <a href="../box2d/Vector.html">Vector</a> argWorld) <a class="anchor-link" href="#getScreenToWorld"
              title="Permalink to CanvasViewportTransform.getScreenToWorld">#</a></h4>
<div class="doc">
<p>Takes the screen coordinates (argScreen) and puts the
corresponding world coordinates in argWorld. It should be safe
to give the same object as both parameters.</p>
<pre class="source">
void getScreenToWorld(Vector argScreen, Vector argWorld) {
  num translationCorrectedX = argScreen.x - translation.x;
  num translationCorrectedY = argScreen.y + translation.y;

  num gridCorrectedX = (translationCorrectedX - extents.x) / scale;
  num gridCorrectedY = ((translationCorrectedY - extents.y) * -1) / scale;
  argWorld.setCoords(gridCorrectedX, gridCorrectedY);
}
</pre>
</div>
</div>
<div class="method"><h4 id="getWorldToScreen">
<span class="show-code">Code</span>
<a href="../dart_core/void.html">void</a> <strong>getWorldToScreen</strong>(<a href="../box2d/Vector.html">Vector</a> argWorld, <a href="../box2d/Vector.html">Vector</a> argScreen) <a class="anchor-link" href="#getWorldToScreen"
              title="Permalink to CanvasViewportTransform.getWorldToScreen">#</a></h4>
<div class="doc">
<p>Takes the world coordinate (argWorld) puts the corresponding
screen coordinate in argScreen.  It should be safe to give the
same object as both parameters.</p>
<pre class="source">
void getWorldToScreen(Vector argWorld, Vector argScreen) {
  // Correct for canvas considering the upper-left corner, rather than the
  // center, to be the origin.
  num gridCorrectedX = (argWorld.x * scale) + extents.x;
  num gridCorrectedY = extents.y - (argWorld.y * scale);

  argScreen.setCoords(gridCorrectedX + translation.x, gridCorrectedY +
      -translation.y);
}
</pre>
</div>
</div>
<div class="method"><h4 id="setCamera">
<span class="show-code">Code</span>
<a href="../dart_core/void.html">void</a> <strong>setCamera</strong>(<a href="../dart_core/num.html">num</a> x, <a href="../dart_core/num.html">num</a> y, <a href="../dart_core/num.html">num</a> s) <a class="anchor-link" href="#setCamera"
              title="Permalink to CanvasViewportTransform.setCamera">#</a></h4>
<div class="doc">
<p>Sets the transform's center to the given x and y coordinates,
and using the given scale.</p>
<pre class="source">
void setCamera(num x, num y, num s) {
  center.setCoords(x, y);
  scale = s;
}
</pre>
</div>
</div>
<div class="method"><h4 id="get:translation">
<span class="show-code">Code</span>
<a href="../box2d/Vector.html">Vector</a> <strong>get translation</strong>() <a class="anchor-link" href="#get:translation"
              title="Permalink to CanvasViewportTransform.get translation">#</a></h4>
<div class="doc">
<p>The current translation is the difference in canvas units between the
actual center of the canvas and the currently specified center. For
example, if the actual canvas center is (5, 5) but the current center is
(6, 6), the translation is (1, 1).</p>
<pre class="source">
Vector get translation() {
  Vector result = new Vector.copy(extents);
  result.subLocal(center);
  return result;
}
</pre>
</div>
</div>
<div class="method"><h4 id="set:translation">
<span class="show-code">Code</span>
<a href="../dart_core/void.html">void</a> <strong>set translation</strong>(<a href="../box2d/Vector.html">Vector</a> translation) <a class="anchor-link" href="#set:translation"
              title="Permalink to CanvasViewportTransform.set translation">#</a></h4>
<div class="doc">

<pre class="source">
void set translation(Vector translation) {
  center.setFrom(extents);
  center.subLocal(translation);
}
</pre>
</div>
</div>
<div class="method"><h4 id="updateTransformation">
<span class="show-code">Code</span>
<a href="../dart_core/void.html">void</a> <strong>updateTransformation</strong>(<a href="../html/CanvasRenderingContext2D.html">CanvasRenderingContext2D</a> ctx) <a class="anchor-link" href="#updateTransformation"
              title="Permalink to CanvasViewportTransform.updateTransformation">#</a></h4>
<div class="doc">
<p>Sets the rendering context such that all drawing commands given in terms
of the world coordinate system will display correctly on the canvas screen.</p>
<pre class="source">
void updateTransformation(CanvasRenderingContext2D ctx) {
  // Clear all previous transformation.
  ctx.setTransform(1,0,0,1,0,0);

  // Translate to the center of the canvas screen. This will be considered the
  // actual origin.
  ctx.translate(extents.x, extents.y);

  // Translate to account for the currently applied translation.
  ctx.translate(translation.x, translation.y);

  // Scale everything according to the current scale and mirror the y-axis.
  ctx.scale(scale, -scale);
}
</pre>
</div>
</div>
<div class="method"><h4 id="get:yFlip">
<span class="show-code">Code</span>
<a href="../dart_core/bool.html">bool</a> <strong>get yFlip</strong>() <a class="anchor-link" href="#get:yFlip"
              title="Permalink to CanvasViewportTransform.get yFlip">#</a></h4>
<div class="doc">
<p>Whether the y axis should be flipped such that y is greater as you get
lower on the screen.</p>
<pre class="source">
bool get yFlip() {
  return true;
}
</pre>
</div>
</div>
<div class="method"><h4 id="set:yFlip">
<span class="show-code">Code</span>
<a href="../dart_core/void.html">void</a> <strong>set yFlip</strong>(<a href="../dart_core/bool.html">bool</a> yFlip) <a class="anchor-link" href="#set:yFlip"
              title="Permalink to CanvasViewportTransform.set yFlip">#</a></h4>
<div class="doc">

<pre class="source">
void set yFlip(bool yFlip) { }
</pre>
</div>
</div>
<h3>Fields</h3>
<div class="field"><h4 id="center">
<span class="show-code">Code</span>
<a href="../box2d/Vector.html">Vector</a>         <strong>center</strong> <a class="anchor-link"
            href="#center"
            title="Permalink to CanvasViewportTransform.center">#</a>
        </h4>
        <div class="doc">
<p>Center of the viewport.  Not a copy.</p>
<pre class="source">
Vector center;
</pre>
</div>
</div>
<div class="field"><h4 id="extents">
<span class="show-code">Code</span>
<a href="../box2d/Vector.html">Vector</a>         <strong>extents</strong> <a class="anchor-link"
            href="#extents"
            title="Permalink to CanvasViewportTransform.extents">#</a>
        </h4>
        <div class="doc">
<p>This is the half-width and half-height.
This should be the actual half-width and
half-height, not anything transformed or scaled.
Not a copy.</p>
<pre class="source">
Vector extents;
</pre>
</div>
</div>
<div class="field"><h4 id="scale">
<span class="show-code">Code</span>
<a href="../dart_core/num.html">num</a>         <strong>scale</strong> <a class="anchor-link"
            href="#scale"
            title="Permalink to CanvasViewportTransform.scale">#</a>
        </h4>
        <div class="doc">
<p>Zoom on the world.</p>
<pre class="source">
num scale;
</pre>
</div>
</div>
        </div>
        <div class="clear"></div>
        </div>
        
        <div class="footer">
          <div>This page generated at 2012-07-21 17:45:07.614</div>
        </div>
        <script async src="../client-live-nav.js"></script>
        </body></html>
        
